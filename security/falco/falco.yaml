# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# Falco Security Monitoring Configuration for AI-Arbeidsdeskundige
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# 
# Runtime security monitoring for:
# - Container anomaly detection
# - System call monitoring
# - Network activity analysis
# - File access monitoring
# - Privilege escalation detection
#
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

# Basic configuration
rules_file:
  - /etc/falco/falco_rules.yaml
  - /etc/falco/falco_rules.local.yaml
  - /etc/falco/rules/ai_arbeidsdeskundige_rules.yaml

# Time format for outputs
time_format_iso_8601: true

# JSON output for better parsing
json_output: true
json_include_output_property: true
json_include_tags_property: true

# Logging
log_stderr: true
log_syslog: true
log_level: info

# Priority threshold
priority: debug

# Buffered outputs
buffered_outputs: false

# Syscall event drops
syscall_event_drops:
  threshold: 0.03
  actions:
    - log
    - alert
  rate: 0.03333
  max_burst: 1000

# Output channels
outputs:
  rate: 1
  max_burst: 1000

# Stdout output
stdout_output:
  enabled: true

# Syslog output
syslog_output:
  enabled: true
  ident: falco
  facility: LOG_USER
  priority: LOG_INFO

# File output
file_output:
  enabled: true
  keep_alive: false
  filename: /var/log/falco/events.log

# Program output for alerting
program_output:
  enabled: true
  keep_alive: false
  program: |
    curl -X POST -H "Content-Type: application/json" \
    -d @- http://monitoring-webhook:8080/falco-alerts

# HTTP output for monitoring integration
http_output:
  enabled: true
  url: http://prometheus-alertmanager:9093/api/v1/alerts
  user_agent: "falco/0.35.0"
  ca_cert: ""
  ca_bundle: ""
  ca_path: ""
  client_cert: ""
  client_key: ""
  echo: false
  headers:
    Content-Type: "application/json"

# gRPC output configuration
grpc_output:
  enabled: false
  address: "unix:///var/run/falco/falco.sock"
  threadiness: 0

# gRPC version
grpc:
  enabled: false
  bind_address: "0.0.0.0:5060"
  threadiness: 0
  private_key: "/etc/ssl/falco/server.key"
  cert_chain: "/etc/ssl/falco/server.crt"
  root_certs: "/etc/ssl/falco/ca.crt"

# Webserver configuration
webserver:
  enabled: true
  listen_port: 8765
  k8s_healthz_endpoint: /healthz
  ssl_enabled: false
  ssl_certificate: /etc/ssl/falco/server.pem

# Resource utilization monitoring
resource_utilization:
  enabled: true
  interval: 1
  buffer_size_preset: 4

# Modern BPF probe
modern_bpf:
  enabled: false

# Engine configuration
engine:
  kind: kmod
  kmod:
    buf_size_preset: 4
    drop_failed_exit: false
  ebpf:
    buf_size_preset: 4
    drop_failed_exit: false
  modern_ebpf:
    buf_size_preset: 4
    cpus_for_each_buffer: 2
    drop_failed_exit: false

# Load plugins
load_plugins: []

# Watch config files
watch_config_files: true

# Metadata download
metadata_download:
  max_mb: 100
  chunk_wait_us: 1000
  watch_freq_sec: 1

# Metrics
metrics:
  enabled: true
  interval: 1h
  output_rule: true
  rules_counters_enabled: true
  resource_utilization_enabled: true
  state_counters_enabled: true
  kernel_event_counters_enabled: true
  libbpf_stats_enabled: true
  plugins_metrics_enabled: true
  convert_memory_to_mb: true
  include_empty_values: false

# Base syscalls for monitoring
base_syscalls:
  custom_set: []
  repair: false